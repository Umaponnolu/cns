import java.io.*; import java.security.*;
 
public class GenerateDigitalSignature { public static void main(String[] args) { try {
String inputFile = "C:\\Users\\Admin\\OneDrive\\Desktop\\1298\\anam.txt";
 
KeyPairGenerator keyGen = KeyPairGenerator.getInstance("DSA", "SUN"); SecureRandom random = SecureRandom.getInstance("SHA1PRNG", "SUN"); keyGen.initialize(1024, random);
 
KeyPair pair = keyGen.generateKeyPair(); PrivateKey priv = pair.getPrivate(); PublicKey pub = pair.getPublic();
 
Signature dsa = Signature.getInstance("SHA1withDSA", "SUN"); dsa.initSign(priv);
 
try (FileInputStream fis = new FileInputStream(inputFile); BufferedInputStream bufin = new BufferedInputStream(fis)) {
 
byte[] buffer = new byte[1024]; int len;
while ((len = bufin.read(buffer)) != -1) { dsa.update(buffer, 0, len);
}
}
byte[] realSig = dsa.sign();
try (FileOutputStream sigfos = new FileOutputStream("C:\\Users\\Admin\\OneDrive\\Desktop\\1298\\signature.txt")) { sigfos.write(realSig);
}
 
byte[] key = pub.getEncoded();
try (FileOutputStream keyfos = new FileOutputStream("C:\\Users\\Admin\\OneDrive\\Desktop\\1298\\publickey.txt")) { keyfos.write(key);
}
 
System.out.println("Digital signature generated successfully!"); System.out.println("C:\\Users\\Admin\\OneDrive\\Desktop\\1298\\signature.txt"); System.out.println("C:\\Users\\Admin\\OneDrive\\Desktop\\1298\\publickey.txt");
 
} catch (Exception e){
 
System.err.println("Caught exception: " + e); e.printStackTrace();
}
}
}
